<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>async 函数</title>
  </head>
  <body>
    <script>
      // 1.async 函数的返回值
      // async 函数的返回值是 Promise 对象
      // async 函数内部 return 后面的值，如果不是 Promise 对象，相当于包了一层 Promise.resolve() 再返回；如果是 Promise 对象，直接返回该 Promise 对象
      // function fn() {
      //   return undefined;
      // }
      // async function fn() {
      //   // return undefined;
      //   // 相当于
      //   // return new Promise(resolve => {
      //   //   resolve(123);
      //   // });

      //   // return Promise.resolve(undefined);
      //   // return 123;
      //   // return Promise.resolve(123);

      //   // return [1, 2, 3];
      //   // return { a: 1 };

      //   return new Promise(resolve => {
      //     setTimeout(() => {
      //       resolve(123);
      //     }, 1000);
      //   });
      // }
      // fn().then(data => {
      //   console.log(data);
      // });
      // console.log(fn());

      // setTimeout(() => {
      //   console.log('setTimeout');
      // }, 0);
      // console.log('执行');

      // 2.async 函数的各种形式
      // 函数声明
      // function fn(){}
      // async function fn(){}

      // 函数表达式
      // const fn = function () {};
      // const fn = async function () {};

      // 箭头函数
      // const fn = () => {};
      // const fn = async () => {};
      // const fn = param => {};
      // const fn = async param => {};

      // 对象的方法
      const obj = {
        // fn:function(){},
        // fn:async function(){},
        // fn:()=>{},
        // fn:async ()=>{},
        // fn(){}
        // async fn(){}
      };

      // Class 的方法
      class ClassName {
        // fn(){}
        async fn() {}
      }
      // console.log(new ClassName().fn());

      // 3.async 函数的注意事项
      // 3.1.可以通过 try...catch 或者 Promise...catch 的方式来处理错误
      async function fn() {
        // return 123;

        // return Promise.reject(new Error('出错了'));

        try {
          // ...
          throw new Error('出错了');
        } catch (error) {
          console.log(error, 'try...catch');
        }
        // // ...
        // throw new Error('出错了');
      }
      fn().catch(err => {
        console.log(err);
      });
      // console.log(fn());

      // 3.2.async 函数中可以没有 await
    </script>
  </body>
</html>
